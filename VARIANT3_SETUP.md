# –í–∞—Ä–∏–∞–Ω—Ç 3: –ì–∏–±—Ä–∏–¥–Ω—ã–π SSR (Hybrid SSR)

## –û–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∞

**–í–∞—Ä–∏–∞–Ω—Ç 3 –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ SSR –∏ SPA:**

- ‚úÖ **–°–µ—Ä–≤–µ—Ä–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è HTML** ‚Üí SEO-friendly, –±—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
- ‚úÖ **–ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö** ‚Üí –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å, –ø—Ä–æ—Å—Ç–æ—Ç–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö API patterns
- ‚úÖ **–ë–µ–∑ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö API-–≤—ã–∑–æ–≤–æ–≤** ‚Üí –ò–∑–±–µ–≥–∞–µ–º –ø—Ä–æ–±–ª–µ–º —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ localhost –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

## –†–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏

| –ê—Å–ø–µ–∫—Ç | –í–∞—Ä–∏–∞–Ω—Ç 1 (SPA) | –í–∞—Ä–∏–∞–Ω—Ç 2 (Full SSR) | **–í–∞—Ä–∏–∞–Ω—Ç 3 (Hybrid)** |
|--------|---|---|---|
| **SSR –≤–∫–ª—é—á–µ–Ω** | ‚ùå | ‚úÖ | ‚úÖ |
| **HTML —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º** | ‚ùå | ‚úÖ | ‚ùå (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞) |
| **–î–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** | ‚ùå | ‚úÖ (—Å–ª–æ–∂–Ω–æ) | ‚ùå |
| **–î–∞–Ω–Ω—ã–µ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ** | ‚úÖ | ‚ùå | ‚úÖ (clientLoader) |
| **SEO** | –ü–ª–æ—Ö–æ–π | –û—Ç–ª–∏—á–Ω—ã–π | –•–æ—Ä–æ—à–∏–π (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞) |
| **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** | ‚úÖ | ‚ö†Ô∏è (API –¥–æ—Å—Ç—É–ø) | ‚úÖ |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å** | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω—è—è |

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### 1. Config –≤–∫–ª—é—á–µ–Ω
```typescript
// react-router.config.ts
ssr: true;  // SSR –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã HTML
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–µ–º clientLoader (–ù–ï loader)

```typescript
// app/routes/home.tsx
export async function clientLoader() {
  const events = await api.getEvents();  // –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
  return { events };
}
```

**–ü–æ—á–µ–º—É clientLoader?**
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ API patterns —Å retry-–ª–æ–≥–∏–∫–æ–π
- –ò–∑–±–µ–≥–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ API –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç BACKEND_URL –¥–ª—è SSR

### 3. Suspense –¥–ª—è –ª—É—á—à–µ–≥–æ UX

```typescript
<Suspense fallback={<LoadingFallback />}>
  <EventGrid events={events} />
</Suspense>
```

## –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ Railway

### –ù–∞ –∫–ª–∏–µ–Ω—Ç–µ:
1. **–ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞**: –ü–æ–ª—É—á–∞–µ—Ç HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–±—ã—Å—Ç—Ä–æ)
2. **React –≥–∏–¥—Ä–∞—Ü–∏—è**: –ü–æ–¥–∫–ª—é—á–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
3. **clientLoader –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è**: –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API
4. **Suspense –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç**: LoadingFallback –ø–æ–∫–∞ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
5. **–†–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç**: EventGrid —Å –ø–æ–ª—É—á–µ–Ω–Ω—ã–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ Railway:
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—É—Å—Ç–æ–π HTML-—à–∞–±–ª–æ–Ω (–Ω–µ—Ç API-–≤—ã–∑–æ–≤–æ–≤)
- –ë—ã—Å—Ç—Ä–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç—É
- –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç backend-—Å–µ—Ä–≤–∏—Å–∞ –Ω–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ

## –ß–µ–∫–ø–æ–π–Ω—Ç –¥–ª—è validation

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã
npm run typecheck

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ clientLoader –≤–µ–∑–¥–µ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω
grep -r "export.*clientLoader" app/routes/

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –Ω–µ—Ç "export async function loader"
grep -r "export async function loader" app/routes/

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ react-router.config.ts —Å–æ–¥–µ—Ä–∂–∏—Ç ssr: true
grep "ssr: true" react-router.config.ts
```

## Environment

–í—Å–µ –Ω—É–∂–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- `BACKEND_URL` (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ) ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è API_URL –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- `API_URL` (–Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ) ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ app/utils/api.ts

```typescript
// app/config/constants.ts
const API_URL = process.env.BACKEND_URL || 'http://localhost:5000';
```

–ù–∞ Railway:
- Frontend (SSR —Å–µ—Ä–≤–µ—Ä): –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç HTML
- Client (–±—Ä–∞—É–∑–µ—Ä): –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ backend-production-190b.up.railway.app/
- Backend (API): –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã

## –†–µ–∑—É–ª—å—Ç–∞—Ç

- üìÑ HTML-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ ‚Üí üîç SEO OK
- ‚ö° –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ ‚Üí üéØ –ù–∞–¥—ë–∂–Ω–æ
- üîÑ Retry-–ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí üõ°Ô∏è –£—Å—Ç–æ–π—á–∏–≤–æ –∫ –æ—à–∏–±–∫–∞–º
- üì± Suspense + LoadingFallback ‚Üí üòä –•–æ—Ä–æ—à–∏–π UX
